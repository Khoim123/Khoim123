-- GUI t·∫°o b·∫±ng Fluent UI Style
local Players = game:GetService("Players")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")

local PLACE_ID = game.PlaceId

-- T·∫°o GUI ch√≠nh
local ScreenGui = Instance.new("ScreenGui", Players.LocalPlayer:WaitForChild("PlayerGui"))
ScreenGui.Name = "ServerBrowser"

local mainFrame = Instance.new("Frame", ScreenGui)
mainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
mainFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
mainFrame.Size = UDim2.new(0, 400, 0, 300)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
mainFrame.Visible = true
mainFrame.ClipsDescendants = true
mainFrame.BorderSizePixel = 0
mainFrame.BackgroundTransparency = 0.05
mainFrame.ZIndex = 2
mainFrame.Name = "FluentFrame"
mainFrame.Active = true
mainFrame.Draggable = true

-- UICorner ƒë·ªÉ l√†m bo g√≥c Fluent Style
local corner = Instance.new("UICorner", mainFrame)
corner.CornerRadius = UDim.new(0, 16)

-- Title
local title = Instance.new("TextLabel", mainFrame)
title.Text = "Tr√¨nh duy·ªát server"
title.Size = UDim2.new(1, 0, 0, 40)
title.BackgroundTransparency = 1
title.Font = Enum.Font.GothamBold
title.TextSize = 22
title.TextColor3 = Color3.fromRGB(255, 255, 255)

-- Danh s√°ch server
local serverList = Instance.new("TextLabel", mainFrame)
serverList.Position = UDim2.new(0, 10, 0, 50)
serverList.Size = UDim2.new(1, -20, 1, -120)
serverList.BackgroundTransparency = 1
serverList.TextWrapped = true
serverList.TextXAlignment = Enum.TextXAlignment.Left
serverList.TextYAlignment = Enum.TextYAlignment.Top
serverList.Font = Enum.Font.Gotham
serverList.TextSize = 14
serverList.TextColor3 = Color3.new(1, 1, 1)
serverList.Text = "ƒêang t·∫£i server..."

-- N√∫t l√†m m·ªõi
local refreshButton = Instance.new("TextButton", mainFrame)
refreshButton.Size = UDim2.new(0, 180, 0, 40)
refreshButton.Position = UDim2.new(0, 10, 1, -50)
refreshButton.Text = "üîÑ L√†m m·ªõi danh s√°ch"
refreshButton.BackgroundColor3 = Color3.fromRGB(0, 120, 215)
refreshButton.TextColor3 = Color3.new(1, 1, 1)
refreshButton.Font = Enum.Font.GothamBold
refreshButton.TextSize = 16
Instance.new("UICorner", refreshButton).CornerRadius = UDim.new(0, 10)

-- N√∫t ·∫©n hi·ªán GUI
local toggleButton = Instance.new("TextButton", ScreenGui)
toggleButton.Size = UDim2.new(0, 120, 0, 35)
toggleButton.Position = UDim2.new(0, 10, 0, 10)
toggleButton.Text = "üëÅÔ∏è ·∫®n/Hi·ªán GUI"
toggleButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
toggleButton.TextColor3 = Color3.new(1, 1, 1)
toggleButton.Font = Enum.Font.GothamBold
toggleButton.TextSize = 14
Instance.new("UICorner", toggleButton).CornerRadius = UDim.new(0, 8)

toggleButton.MouseButton1Click:Connect(function()
	mainFrame.Visible = not mainFrame.Visible
end)

-- H√†m t√¨m server t·ªët nh·∫•t
local function findBestServer()
	serverList.Text = "ƒêang t√¨m server t·ªët nh·∫•t..."
	local cursor = ""
	local bestServer = nil
	local lowestPlayers = math.huge

	while true do
		local url = string.format("https://games.roblox.com/v1/games/%d/servers/Public?limit=100&sortOrder=Asc&cursor=%s", PLACE_ID, cursor)
		local success, result = pcall(function()
			return HttpService:JSONDecode(game:HttpGet(url))
		end)

		if success and result and result.data then
			for _, server in ipairs(result.data) do
				if server.playing < lowestPlayers and server.id ~= game.JobId then
					bestServer = server
					lowestPlayers = server.playing
				end
			end
			if result.nextPageCursor then
				cursor = result.nextPageCursor
			else
				break
			end
		else
			serverList.Text = "L·ªói khi t·∫£i d·ªØ li·ªáu server."
			return
		end
	end

	if bestServer then
		serverList.Text = string.format("ƒê√£ t√¨m th·∫•y server t·ªët nh·∫•t:\nüë• Ng∆∞·ªùi ch∆°i: %d\nüÜî Server ID: %s\n\nNh·∫•p n√∫t ƒë·ªÉ chuy·ªÉn...", bestServer.playing, bestServer.id)
		return bestServer.id
	else
		serverList.Text = "Kh√¥ng t√¨m th·∫•y server ph√π h·ª£p."
		return nil
	end
end

-- N√∫t l√†m m·ªõi danh s√°ch v√† chuy·ªÉn server
refreshButton.MouseButton1Click:Connect(function()
	local bestServerId = findBestServer()
	if bestServerId then
		wait(2)
		TeleportService:TeleportToPlaceInstance(PLACE_ID, bestServerId, Players.LocalPlayer)
	end
end)

-- T·∫£i server l·∫ßn ƒë·∫ßu
task.spawn(findBestServer)